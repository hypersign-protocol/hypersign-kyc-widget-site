(function(){"use strict";var e={15006:function(e,t,n){var s=n(65514);const r=new s.ZP.WebAuth({domain:"fidato.us.auth0.com",clientID:"hwM9GmM4nUstds9Fw5KsYZVDboJBeLTL",responseType:"token id_token",scope:"openid profile email"});t.Z=r},64072:function(e,t,n){var s=n(28047),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],a=(n(57658),{env:"stage",steps:{faceRecog:!0,idOcr:!0},schemaIds:{PersonhoodCredential:{schemaId:"sch:hid:testnet:z6Mkvtd73dDgg7HU8wLCmXbe2RAHPAU1Ex1VUXCFtPV7u36i:1.0",issuer:"did:hid:testnet:zCyAz2wfKjAaWE4FW75KxpZh2wuo9kRAUZyV2xEe93cKr"},PassportCredential:{schemaId:"sch:hid:testnet:z6MkgMXXQL7YD7BufNLbjrwueoj4nmih9xujJ6aozJDmzFWx:1.0",issuer:"did:hid:testnet:zCyAz2wfKjAaWE4FW75KxpZh2wuo9kRAUZyV2xEe93cKr"}},licenseKey:{stage:"3D430010231C062B0411476A4A2707434F4734070A330C060B243C103604415F72240025040D16352D0730040F0A200D4B6A430F0C330D073504415F2B4A0A290C0E003E1C1A645B412B114A4564050211352D072243594762585B724C53527D5A5F644D4100281C1B27250211314A536452275163582F76225056602C5971525655645A5E76205056612C597253505516595E7256552464295807505754665A5B745552546359590353545769582F7753532463585B75522055605B5D76505150625C5A03525150645B2877225554652A597E50525663582D7527535D63515805535755135B5C73545057622E5973532155645B597351505D602A5B77515657655D2B76205056605D59715625551358517450525C625F5803505057165D2873525427652B5B765321546959587627515C62595902565155655D5874595223612E597E51225464582B75575250605F5A7E565050695A517625515C625C5973515255665C2A7522532461585A0256545663585D7353535160295B7051535066582F7554505C625B5C07505050675B5D7451505663515C7F512156635C2A7627525760595C02502050675B5C75525324625D5976525556635B5C7557522460585A03522550625A2872205257645B5B04512157625B2B76515220652C5C7E56565612585073225026622A5A02535254625D5B74505250612C5974525056635B5874585153632E5B03535350675D5B7657505C65295B76572754695A2F7353535D622A5970532657155A5E76235024612C5A0551275468595D76565124652E5903565555135D587453525D605A5A05535754125B507353515C612D5B735025556958517322515761585B0356525660585C7653555062585905535757695B5B74585357632C5877505655625A2D765951556051597E51205769592B76245154615A5C025226566658287651555C6259597751225462585F77555053632B5974505150665C5872585457605C597653565564582D77575050632B597053275564582D74505023602A580553215564582D77505457655A5D04522756145C5876575150612A5802535A5513585F7756532664295C75502251635A2D7455532664295D7350225163585E76205056612C597253505516595E7550515C61505905502251635D5075585457625C597653565564582D77575050622C597152535564582F76205155602C5A73575751145B2F72565026605959075350551659597651532664295C75522756145C5876575023605D597253505516595E7757532664295C75502251635A2D7455532664295D7350225163585E76555151602C5B05535B55655B2F72565524635C5D04565750615D587350542165505C03572150635D5C75585457645C5A7357575514582876575050605E580753505765582A76575150605D5905535B54655B2F72565524635C5D0452565663595D7455525462515A76535255605A2B76585152635A5A7751205412585B75535051612C5B73505254655D5F7522515C65515C07535456665B587623532463585A7E52505563582C7552555560295B0353225513585F7557555060585907512657625A5E73255023602A5972535B5068582C7624525162595B70525256645A2D73225553645B5C0251255513592B7756502461595B7653515065585E73565221625F580353545714595F76255356622C5970505450645D2B7424505D61595B7353225766585D7220535C635A5877505150605B5876535552632B5904515A57675D5D7658535560595B74565656645D5C75535250602A5A7E565557135B587220502462295976565156125D5C75525353635A5B72532554615B5875525356625A5977505254685D597422542362295D74515757135A5975255050625E5C05565450625B507627555C605C5B0750515566595973555251622C5805532754645B5875565226612D5A03515255675D5C7355505660595C0451255111592B7458555263585B07535A55695A2A74505020605A580550505711592877535057615A5C0353525061582C7356525262585975505055635950752755526159580051225668582B7624555C61295877515250665B5B76525052652C5B77535055635A2B7555522663295A05522656625859742350216150597E535457125A2B7725502761515875565154695B5D7622505065595B7653265714595976515154602D5A02532756655D5D75585457645C5A7357575461585B765750276051590353505716585B76595050635C5D04562056145C587625515C6150590552575462582876535020645D5974522555625C2C7753505C602B5903535054655C2D76235050612B5973532555675928722350546150587F502251635C2F75585457602C597153525568582D765153516159587F535056145C587327532664295B7253255562595876205057605C5976535B55115B2F72565426635C5D0452555463582A76505150602A5802502251635D5075585457632A590553225461582B74225251635C5D04572256145C58775250506129580753255515582D75585457655A5A73575750605C2D7354532664295872572256145C5877545157605F580053255565585F7756532664295C75502251635A5C76555056602C5A7F532655685B2F7256512164295D7357575514582A7653505260595971535251635D5076525054605C5807535051145C5876515020602E5976535B55645B5E77225155602C5D04562051635A2C76225056612959705357551458287623502764295872434F473C010A230F100014070A330C060B244A53321316007C4A052F02060B230D2F27020A043C4A5320000F1635444B2A0800003E1B0C120E08003E2C0625140E003E1C4B7C15111035444B2A0E040239060E645B05043C1B0C6A430C1672524B070F1A477C4A1927020804370D27270C06476A4A013F11061723010E284C081C33451E2F05040024460723150F0C361147271113477C4A0C28060A0B353C103604415F72250025130C073C01072D434F47201A062214001172524B15040F1538212D644D4113351A1A2F0E0D476A4A58685141187C4A19340E150C340D1B645B4123310B0C16090A472D",dev:"3D430010231C062B0411476A4A2707434F4734070A330C060B243C103604415F72240025040D16352D0730040F0A200D4B6A430F0C330D073504415F2B4A0A290C0E003E1C1A645B412B114A4564050211352D072243594762585B724C52577D5B58644D4100281C1B27250211314A536452275163582F76225056602C5971525655645A5E76205056612C597253505516595E7256552464295807505754665A5B7455525463595B75535757665D287627535C632E5877535A55635D597423555561295D70532257155B5A76535023645F5803565650645A5977545224605C5A0351275664595972205324645B590052545768595E7555525C62295A0556515565585C7423525462595807502654645D2876585056602E5A77535656635C2A7657555C625D597552525667595D7650535D625B5904565257695A5E73555557612A5D7450525666585C7354522062515970525555155D5E7424515C61295B70525457655A2C74505427612B5C7F532750655D5F75525152622C5A0752565468585D77275553602B5B725252506559597658525665585C7F575A50695B50765153576258587E505257125A2A7752502763505A7F51215660592874565356622D5A75532155665A2D7423515063505A7656505412582F74235021605B5D7051545767585F7525525360515B72505657695A2F7651515160515C05565350605D5C73525257605E580453565711585F7551505D62595A7F565450635A507751555165515A0551515061585F7423535061515B07522650645A5E7422505160515B74515255605D5B7425532465595C03565650685A587322555163515903505150655A5076255352622E597056565464585077555457645C5D0453225568585976515020612A590550515515585176515020622B597053565464582C76515020612B5D0456205163595175585457602A580552565465582A7659505061295A73575750125B2F7256522062515A73575751145B2F72565051605F590752505513585F76235151632B5876525555645B2F72565524635C5D0451225568585976515020612A590551505516595C76515026605F587F535056145C58725853266429597353255562585F76235156602C5A7357575012595175585457602A597053215513585F76235151612A5A73575750125B2F7256522062515A73575751145B2F725650516051580253505764582D7650532664295C75502251635D5873545557652B5D72565450635C2C73575554635C5D04572256145C587658505C602A5905535B5462585F74505023602A580553215564582D7750532664295C755022516359597556515262515B7E515456685A50765652526559597550255666592B76205057652A5B71565554635C2A7658522363505903535A5115595D73575550622A587F512055145B5D74245350612A5D7050205111585C7755525C612B5A7E512557635B5F73505051602D5B715154576859597525515065595973535655665B2B76575357645F590756255713585077535353612E59025026571158587353525D622B5C7E565754625C5175535352602D5C7F515B5760582A77545023652B5B74522554635A2A77555251625D5B02572754655D5A76245551652C5A00525257645B597757515C602E5875565355655A2C77535551612A5973515650695D5A7220555D635A590550575769595B75535224625F5800532756615B5A7459535461595B04505657675B5076595052625E5B71525056615B2873515124605C5B71532155115C2A74555253602C5A77515355605A2C7557525D625C5905525155605D5F73525554652D5C0051575516595876575227602C5A05532657685B5A73555557625A5805565150605B5F74505555602C5B71505054605A5977255550622B5B76535155605A517453505465515B77502050685D5D7357555C62295C7656515660585D75505551625A597750525766582A73575150605A587E502251635C2F755854576150597E53565511585B76535050625E597E532155645B2F72565524635C5D045322551558597655502660585970525654655B2F72565426635C5D0453505516585D76225020602C5A0252255461585F75585457655A5A7357575713582876575157605F590453225568582D7624532664295D7350225163595A77565023602B5805535654655B2F72565524635C5D0450565564582F7754505D62595B02502251635C2F75585457612D590552575462582876205020635C5D04562056145C587355542065505A73575754135C2F7558545761505804535A546758287650505061295A73575750125B2F725652536051590753505661582B7622532664295872575751145C5876585023602E590353255516585D72565524602D597E53225462585F72585457602C597153525568582D765153516159587F535051635D5072565221605959075257551558587658505C605E5974575754134A45640D0A0635061A23250C0625050C2815415F241A1C234D4109390B0C28120623310B00270D415F36090535044F473C010A230F1000040702230F270A331D04230F17476A1C1B33044F473C070E21080D0272520F270D10007C4A0635435947110610644D4115310B022706062B31050C645B41093F0B082A090C16244A4564040D0239060C1218130072524B0B0800173F0A052F0F08477C4A19340E0710331C4B7C4330003C18010F254149721E0C34120A0A3E4A5364504D557215456411110A26010D2313415F722E082504330D394A14"}}),i=n(87896),c={name:"App",components:{},methods:{...(0,i.OI)(["setSteps","setTrustedSchemaIdsAndIssuers","setIdDocumentLicenseKey"])},async created(){if(!a)throw new Error("Invalid widget configuration");if(!(Object.keys(a.steps).length>0))throw new Error("Invalid widget configuration, steps is required");{let e=[{id:0,isActive:!0,stepName:"SignIn",previous:0},{id:1,isActive:!1,stepName:"VaultPIN",previous:0},{id:2,isActive:!1,stepName:"AppInstructions",previous:1}];if(a.steps.faceRecog&&a.steps.idOcr)e.push({id:e.length,isActive:!1,stepName:"Liveliness",name:"Facial Recognition",previous:e.length-1}),e.push({id:e.length,isActive:!1,stepName:"IdDocs",name:"Government-issued ID",previous:e.length-1});else if(a.steps.faceRecog&&!a.steps.idOcr)e.push({id:e.length,isActive:!1,stepName:"Liveliness",name:"Facial Recognition",previous:e.length-1});else if(!a.steps.faceRecog&&a.steps.idOcr)e.push({id:e.length,isActive:!1,stepName:"Liveliness",name:"Facial Recognition",previous:e.length-1}),e.push({id:e.length,isActive:!1,stepName:"IdDocs",name:"Government-issued ID",previous:e.length-1});else if(!a.steps.faceRecog&&!a.steps.idOcr)throw new Error("Invalid widget configuration");e.push({id:e.length,isActive:!1,stepName:"UserConsent",name:"Provide User Consent",previous:e.length-1}),e.push({id:e.length,isActive:!1,stepName:"FinalResult",previous:e.length-1}),this.setSteps(e)}if(!a.schemaIds)throw new Error("Invalid widget configuration, schemaIds is required");this.setTrustedSchemaIdsAndIssuers(a.schemaIds),a.licenseKey&&("dev"===a.env?this.setIdDocumentLicenseKey(a.licenseKey.dev):"stage"===a.env?this.setIdDocumentLicenseKey(a.licenseKey.stage):this.setIdDocumentLicenseKey(a.licenseKey.dev))}},u=c,l=n(43736),d=(0,l.Z)(u,r,o,!1,null,null,null),h=d.exports;n(61074),n(3060),n(82801);const g="https://api.entity.hypersign.id",p="0a88981d30e66a8b188760b081c14.02178535aa9c0ee9fe6cf4e2e3902559f12357c93d44df1959229122def5be650303272f2dc4d5443cb7275c25e2566e5",f="https://stage.hypermine.in/kavach",A="https://<subdomain>.api.cavach.hypersign.id/api/v1",m=n(29251),C=256,D=1e4;async function v(e,t){if(!t)throw Error("Encryption error: Password is empty.");if(!e)throw Error("Encryption error: Message is empty.");const n=m.lib.WordArray.random(16),s=m.PBKDF2(t,n,{keySize:C/8,iterations:D}),r=m.lib.WordArray.random(16),o=m.AES.encrypt(e,s,{iv:r,padding:m.pad.Pkcs7,mode:m.mode.CBC}),a=n.toString()+r.toString()+o.toString();return a}async function y(e,t){if(!t)throw Error("Decryption error: Password is empty.");if(!e)throw Error("Decryption error: Message is empty.");const n=m.enc.Hex.parse(e.substr(0,32)),s=m.enc.Hex.parse(e.substr(32,32)),r=e.substring(64),o=m.PBKDF2(t,n,{keySize:C/8,iterations:D}),a=m.AES.decrypt(r,o,{iv:s,padding:m.pad.Pkcs7,mode:m.mode.CBC});if(!a)throw Error("Decryption error: Could not decrypt the data. Please check your password.");return a.toString(m.enc.Utf8)}s.ZP.use(i.ZP);var B=new i.ZP.Store({state:{qrString:"",phoneNumber:"",finalResult:{},aadharData:{},authorization:null,steps:[],schemaIds:{},hasLivelinessDone:!1,hasKycDone:!1,kycExtractedData:{},finalResults:!1,livelinessResult:{},ocrIDDocResult:{},livelinessCapturedData:{tokenSelfiImage:""},kycCapturedData:{tokenFrontDocumentImage:"",tokenFaceImage:"",countryCode:""},authenticationAccessToken:{},ifNewUser:!1,userPresentationConsent:{},idToken:"",idDocumentLicenseKey:""},getters:{getActiveStep:e=>{const t=e.steps.find((e=>1==e.isActive));if(!t){const t=e.steps.find((e=>1==e.isActive));return t}return t},getSession(){return localStorage.getItem("session")},getCavachAccessToken(){return localStorage.getItem("cavachAccessToken")},getRedirectUrl(){return localStorage.getItem("redirectUrl")},getAuthServerAuthToken(){return localStorage.getItem("authServerAuthToken")},getFinalResult(e){return e.finalResult},getProfile(){const e=localStorage.getItem("profile");return e?JSON.parse(e):null},getVaultPin(){return localStorage.getItem("vaultPin")},getVaultLockStatus(){return localStorage.getItem("vaultLockStatus")},getVaultData(){return localStorage.getItem("vaultData")},getVaultDataRaw(){const e=localStorage.getItem("vaultDataRaw");return JSON.parse(e)},getVaultDataCredentials(e={}){console.log("filterCondition ="+e);const t=localStorage.getItem("vaultDataRaw"),n=JSON.parse(t),{hypersign:s}=n,{credentials:r}=s;return r},getUserDID(){const e=localStorage.getItem("vaultDataRaw");if(e){const t=JSON.parse(e),{hypersign:n}=t;if(n)return n.did}},getPresentationRequest(){return localStorage.getItem("presentationRequest")},getSSIAccessToken(){return localStorage.getItem("ssiAccessToken")},getPresentationRequestParsed(){const e=localStorage.getItem("presentationRequest"),t=atob(e);return JSON.parse(t)},getTenantSubdomain(){return localStorage.getItem("subdomain")},getTenantKycServiceBaseUrl(){const e=localStorage.getItem("subdomain");if(!e)throw new Error("Invalid accessToken");return A.replace("<subdomain>",e)},getIdDocumentLicenseKey(e){return e.idDocumentLicenseKey}},mutations:{setSteps:(e,t)=>{e.steps=t},setTrustedSchemaIdsAndIssuers:(e,t)=>{e.schemaIds=t},nextStep:(e,t=null)=>{const n=e.steps.find((e=>1==e.isActive)),s=t||n.id+1;e.steps[n.id].isActive=!1,e.steps[s].isActive=!0},previousStep:e=>{const t=e.steps.find((e=>1==e.isActive)),n=t.previous;e.steps[t.id].isActive=!1,e.steps[n].isActive=!0},setAuthorization:(e,t)=>{e.authorization=t,localStorage.setItem("authorization",t)},setQrString:(e,t)=>{e.qrString=t},setImage:(e,t)=>{e.imageData=t},setPhoneNumber:(e,t)=>{e.phoneNumber=t},setFinalResult:(e,t)=>{e.finalResult={...t}},setAadhaarData:(e,t)=>{e.aadharData={...t}},setLivelinessDone(e,t){e.hasLivelinessDone=t},setKycDone(e,t){e.hasKycDone=t},setSession(e,t){console.log(e.hasKycDone),localStorage.setItem("session",t)},setKycExtractedData(e,t){e.kycExtractedData=t.data,e.hasKycDone=t.status},setCavachAccessToken(e,t){console.log(e.kycCapturedData),localStorage.setItem("cavachAccessToken",t)},setRedirectUrl(e,t){console.log(e.kycCapturedData),localStorage.setItem("redirectUrl",t)},setPresentationRequest(e,t){console.log(e.kycCapturedData),localStorage.setItem("presentationRequest",t)},setSSIAccessToken(e,t){console.log(e.kycCapturedData),localStorage.setItem("ssiAccessToken",t)},setResult(e,t){e.finalResult=t},setLivelinessResult(e,t){e.livelinessResult={...t}},setOcrIdDocResult(e,t){e.ocrIDDocResult={...t}},setLivelinessCapturedData(e,t){e.livelinessCapturedData={...t}},setKycCapturedData(e,t){e.kycCapturedData={...t}},setThridPartyAuth(e,t){e.authenticationAccessToken={...t}},setProfile(e,t){console.log(e.hasKycDone),localStorage.setItem("profile",JSON.stringify(t))},setAuthServerAuthToken(e,t){console.log(e.hasKycDone),localStorage.setItem("authServerAuthToken",t)},setVaultPin(e,t){console.log(e.hasKycDone),localStorage.setItem("vaultPin",t)},setVaultData(e,t){console.log(e.hasKycDone),localStorage.setItem("vaultData",t)},setVaultRaw(e,t){console.log(e.hasKycDone),localStorage.setItem("vaultDataRaw",t)},setVaultLockStatus(e,t){console.log(e.hasKycDone),localStorage.setItem("vaultLockStatus",t)},setAsNewUser(e,t){console.log(e.hasKycDone),e.ifNewUser=t},setUserPresentationConsent(e,t){e.userPresentationConsent=t},setIdToken(e,t){e.idToken=t},setTenantSubdomain(e,t){console.log(e.hasKycDone),localStorage.setItem("subdomain",t)},setIdDocumentLicenseKey(e,t){e.idDocumentLicenseKey=t}},actions:{addharQRVerify:({state:e})=>new Promise(((t,n)=>{console.log("Inside addharQRVerify");const s=f+"/api/v1/aadhaar/qr/verify";fetch(s,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:e.authorization},body:JSON.stringify({qrString:e.qrString})}).then((e=>e.json())).then((e=>{if(400==e.statusCode)throw new Error("Bad Request "+e.message.toString());t(e)})).catch((e=>{n(e.message)}))})),setJWT:({commit:e})=>new Promise(((t,n)=>{const s=g+"/api/v1/app/oauth";fetch(s,{method:"POST",headers:{"Content-Type":"application/json","X-Api-Secret-Key":p},body:void 0}).then((e=>e.json())).then((n=>{if(400==n.statusCode)throw new Error("Bad Request "+n.message.toString());e("setAuthorization","Bearer "+n.access_token),t()})).catch((e=>{n(e.message),localStorage.removeItem("authorization")}))})),setSession:({state:e})=>new Promise(((t,n)=>{console.log("Inside addharQRVerify");const s=f+"/api/v1/aadhaar/session";fetch(s,{method:"POST",credentials:"include",headers:{"content-type":"application/json",Authorization:e.authorization},body:void 0}).then((e=>e.json())).then((e=>{if(400==e.statusCode)throw new Error("Bad Request "+e.message.toString());t(e)})).catch((e=>{n(e.message)}))})),verifyPhoneNumber:({state:e})=>new Promise(((t,n)=>{console.log("Inside addharQRVerify");const s=f+"/api/v1/aadhaar/ph/verify";fetch(s,{method:"POST",credentials:"include",body:JSON.stringify({phoneNumber:e.phoneNumber}),headers:{"content-type":"application/json",Authorization:e.authorization}}).then((e=>e.json())).then((e=>{if(400==e.statusCode)throw new Error("Bad Request "+e.message.toString());t(e)})).catch((e=>{n(e.message)}))})),verifyImage:({state:e})=>new Promise(((t,n)=>{console.log("Inside verifyImage");const s=f+"/api/v1/aadhaar/img/verify";fetch(s,{method:"POST",credentials:"include",body:JSON.stringify({userImage:e.imageData}),headers:{"content-type":"application/json",Authorization:e.authorization}}).then((e=>e.json())).then((e=>{if(400==e.statusCode)throw new Error("Bad Request "+e.message.toString());t(e)})).catch((e=>{n(e.message)}))})),getFinalResult:({state:e})=>new Promise(((t,n)=>{console.log("Inside addharQRVerify");const s=f+"/api/v1/aadhaar/result";fetch(s,{method:"GET",credentials:"include",headers:{Authorization:e.authorization,"content-type":"application/json"}}).then((e=>e.json())).then((e=>{if(400==e.statusCode)throw new Error("Bad Request "+e.message.toString());t(e)})).catch((e=>{n(e.message)}))})),getNewSession:({commit:e,getters:t},n)=>new Promise(((s,r)=>{const o=`${t.getTenantKycServiceBaseUrl}/e-kyc/verification/session`,a={Authorization:"Bearer "+t.getCavachAccessToken,Origin:"http://localhost:4999/","content-type":"application/json"};return fetch(o,{method:"POST",headers:a,body:JSON.stringify(n)}).then((e=>e.json())).then((t=>{t.statusCode&&200!=t.statusCode?r(t.message):t.error?r(t):(t&&e("setSession",t.sessionId),s(t))})).catch((e=>{r(new Error(`Error while fetching session  ${e}`))}))})),verifyResult:({commit:e,getters:t,state:n})=>new Promise(((s,r)=>{if(Object.keys(n.userPresentationConsent).length<=0)return r(new Error("No user consent found"));const o=`${t.getTenantKycServiceBaseUrl}/e-kyc/verification/user-consent`,a={Authorization:"Bearer "+t.getCavachAccessToken,Origin:"http://localhost:8080/","content-type":"application/json"};return fetch(o,{method:"POST",headers:a,body:JSON.stringify({sessionId:t.getSession,presentation:n.userPresentationConsent})}).then((e=>e.json())).then((t=>{t.statusCode&&200!=t.statusCode?r(t.message):t.error?r(t):(t&&!0===t.success&&(e("setResult",t.success),e("setIdToken",t.idToken)),s(t))})).catch((e=>{r(new Error(`Verifying the result  ${e}`))}))})),verifyLiveliness:({commit:e,state:t,getters:n,dispatch:s})=>new Promise(((r,o)=>{if(""===t.livelinessCapturedData.tokenSelfiImage||!t.hasLivelinessDone)return o("User has not performed liveliness check");const a=`${n.getTenantKycServiceBaseUrl}/e-kyc/verification/passive-liveliness`,i={Authorization:"Bearer "+n.getCavachAccessToken,Origin:"http://localhost:8080/","content-type":"application/json","x-ssi-access-token":n.getSSIAccessToken,"x-issuer-did":n.getPresentationRequestParsed.issuerDID,"x-issuer-did-ver-method":n.getPresentationRequestParsed.issuerDIDVerificationMethod};return fetch(a,{method:"POST",headers:i,body:JSON.stringify({sessionId:n.getSession,tokenSelfiImage:t.livelinessCapturedData.tokenSelfiImage,userDID:n.getUserDID})}).then((e=>e.json())).then((async t=>t.statusCode&&200!=t.statusCode?o(t.message):t.error?o(t):t&&3===t.serviceLivenessResult?(e("setLivelinessResult",t),await s("updateVaultCredentials",t.credential),r(t)):void o(new Error("Error verifying liveliness check, error code: "+t.serviceLivenessResult)))).catch((e=>o(new Error(`Verifying the result  ${e}`))))})),verifyOcrIDDoc:({commit:e,state:t,getters:n,dispatch:s})=>new Promise(((r,o)=>{if(""===t.kycCapturedData.tokenFrontDocumentImage||!t.hasKycDone)return o("User has not performed ID capturing");const a=`${n.getTenantKycServiceBaseUrl}/e-kyc/verification/doc-ocr`,i={Authorization:"Bearer "+n.getCavachAccessToken,Origin:"http://localhost:8080/","content-type":"application/json","x-ssi-access-token":n.getSSIAccessToken,"x-issuer-did":n.getPresentationRequestParsed.issuerDID,"x-issuer-did-ver-method":n.getPresentationRequestParsed.issuerDIDVerificationMethod};return fetch(a,{method:"POST",headers:i,body:JSON.stringify({documentType:0,tokenFrontDocumentImage:t.kycCapturedData.tokenFrontDocumentImage,tokenFaceImage:t.kycCapturedData.tokenFaceImage,countryCode:t.kycCapturedData.countryCode,sessionId:n.getSession,userDID:n.getUserDID})}).then((e=>e.json())).then((t=>t.statusCode&&200!=t.statusCode?o(t.message):t.error?o(t):t&&0===t.serviceFacialAuthenticationResult?(e("setOcrIdDocResult",t),t.credentials&&t.credentials.length>0&&t.credentials.forEach((e=>{console.log("Updating each credentila in vault credential id "+e.id),s("updateVaultCredentials",e)})),r(t)):o(new Error("Error verifying ID document, error code: "+t.serviceFacialAuthenticationResult)))).catch((e=>{o(new Error(`Verifying the result  ${e}`))}))})),registerUser:({commit:e,getters:t})=>new Promise(((n,s)=>{const r="https://authserver.hypersign.id/hs/api/v2/register",o={"content-type":"application/json"},{email:a,name:i,accessToken:c}=t.getProfile;return fetch(r,{method:"POST",headers:o,body:JSON.stringify({user:{name:i,email:a,did:"did:hid:testnet:z6MkwF5rDNi3oKiUaqA5aN9yLDW5zTUA4ghshW8Soq4M92ED"},isThridPartyAuth:!0,expirationDate:"2030-12-31T00:00:00.000Z",thridPartyAuthProvider:"Google",accessToken:c})}).then((e=>e.json())).then((t=>{if(t){if(t.error)return s(t.error);403===t.status?e("setAsNewUser",!1):e("setAsNewUser",!0),e("setAuthServerAuthToken",t.authToken),n(t)}})).catch((e=>{s(new Error(`Verifying the result  ${e}`))}))})),syncUserData:({getters:e})=>new Promise(((t,n)=>{const{email:s}=e.getProfile;if(!s)return n(new Error("Invalid email, or user is not logged in"));if(!localStorage.getItem("vaultData"))return n(new Error("Invalid vault data"));const r="https://authserver.hypersign.id/hs/api/v2/sync",o={"content-type":"application/json",Authorization:"Bearer "+e.getAuthServerAuthToken};return fetch(r,{method:"POST",headers:o,body:JSON.stringify({user:{userId:s,sequenceNo:0,docId:"randomId"},document:{encryptedMessage:localStorage.getItem("vaultData")}})}).then((e=>e.json())).then((e=>{if(e){if(e.error)return n(e.error);t()}})).catch((e=>{n(e)}))})),syncUserDataById:({getters:e,commit:t})=>new Promise(((n,s)=>{const{email:r}=JSON.parse(localStorage.getItem("profile"));if(!r)return s(new Error("Invalid email, or user is not logged in"));const o="https://authserver.hypersign.id/hs/api/v2/sync/"+r,a={"content-type":"application/json",Authorization:"Bearer "+e.getAuthServerAuthToken};return fetch(o,{method:"GET",headers:a}).then((e=>e.json())).then((e=>{if(e){if(e.error)return s(e.error);t("setVaultData",e.encryptedMessage),n()}})).catch((e=>{s(e)}))})),async lockVault({commit:e,getters:t}){try{const n=t.getVaultPin;let s=t.getVaultDataRaw;if(!s)return!1;if(!0===t.getVaultLockStatus)throw new Error("Vault is already locked");const r=await v(JSON.stringify(s),n);return await e("setVaultData",r),await e("setVaultLockStatus",!0),!0}catch(n){throw new Error("Error: Could not lock vault")}},async unlockVault({commit:e,getters:t}){try{const n=t.getVaultPin,s=t.getVaultData;if(!1===t.getVaultLockStatus)throw new Error("Vault is already unlocked");if(!s||"undefined"===s)return!1;const r=await y(s,n);if(""===r)throw new Error("Error: Could not unlock vault, please check your PIN");return r&&(e("setVaultRaw",r),e("setVaultLockStatus",!1)),!0}catch(n){throw new Error(n.message)}},async updateVaultCredentials({commit:e,getters:t,dispatch:n},s){try{if(!0===t.getVaultLockStatus)throw new Error("Vault is locked, please unlock first");const r=t.getVaultDataRaw;r.hypersign.credentials.push(s),r&&e("setVaultRaw",JSON.stringify(r)),await n("lockVault"),setTimeout((async()=>{n("syncUserData"),console.log("After calling syncUserData ... ")}),2e3)}catch(r){throw new Error(r.message)}},async checkIfCredentialAlreadyExistsInVault({commit:e,getters:t,state:n}){if(!0===t.getVaultLockStatus)throw new Error("Vault is locked, please unlock first");const s=t.getVaultDataRaw,{hypersign:r}=s,{credentials:o}=r,{schemaIds:a}=n;Object.keys(a).forEach((t=>{const{schemaId:n}=a[t],s=o.some((e=>{if(e&&e.credentialSchema.id===n)return e}));s&&("PersonhoodCredential"===t&&(console.log("commiting setLivelinessDone"),e("setLivelinessDone",!0)),"PassportCredential"===t&&e("setKycDone",!0))}))}}}),S=n(70326),E=n.n(S),w=function(){var e=this,t=e._self._c;return"error"===e.type?t("div",{staticStyle:{"background-color":"rgba(253, 170, 170, 0.972)",bottom:"16px",width:"96%",height:"20px","border-radius":"2px","z-index":"99999","text-align":"left","padding-left":"5px","padding-right":"5px","font-size":"small",color:"darkslategrey"}},[e._v(" "+e._s(e.shortenMesssage)+" ")]):t("div",{staticStyle:{"background-color":"rgb(184, 230, 184)",bottom:"16px",width:"96%",height:"20px","border-radius":"2px","z-index":"99999","text-align":"left","padding-left":"5px","padding-right":"5px","font-size":"small",color:"darkslategrey"}},[e._v(" "+e._s(e.msg)+" ")])},k=[],F={props:{msg:String,type:{String:String,default:"success"}},computed:{shortenMesssage(){return console.log(this.msg),this.msg.length>40?this.msg.substr(0,40)+"...":this.msg}},created(){console.log("Toast created")},mounted(){console.log(this.type)},data(){return{}}},I=F,P=(0,l.Z)(I,w,k,!1,null,"636f4afc",null),b=P.exports,T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"navbar navbar-expand-md navbar-light"},[t("div",{staticClass:"container"},[e._m(0),e.getActiveStep.name?t("span",{staticStyle:{float:"right","padding-right":"10px","padding-top":"4px","padding-left":"10px",border:"1px solid #808080eb","border-radius":"33px","padding-bottom":"4px",background:"#80808024"}},[e._v(" "+e._s(e.getActiveStep.name)+" ("+e._s(e.getActiveStep.id-2)+"/"+e._s(e.kycStepsLength)+") ")]):e._e()])])},O=[function(){var e=this,t=e._self._c;return t("a",{staticClass:"navbar-brand",attrs:{href:"#"}},[t("img",{attrs:{src:n(40633),width:"100px"}})])}],R={computed:{...(0,i.rn)(["steps"]),...(0,i.Se)(["getActiveStep"]),kycStepsLength(){return this.steps.filter((e=>null!=e.name)).length}}},x=R,_=(0,l.Z)(x,T,O,!1,null,null,null),N=_.exports,L=function(){var e=this,t=e._self._c;return t("div",[t("h1",[e._v(e._s(e.header))]),t("h6",{staticStyle:{color:"grey"}},[e._v(" "+e._s(e.subHeader)+" ")])])},V=[],j={props:{header:String,subHeader:String}},K=j,U=(0,l.Z)(K,L,V,!1,null,null,null),z=U.exports,Z=n(71258),q=function(){var e=this;e._self._c;return e._m(0)},M=[function(){var e=this,t=e._self._c;return t("p",{staticClass:"consent-message"},[t("span",[e._v(" By continuing, you agree to our "),t("a",{attrs:{href:"#",target:"_blank"}},[e._v("terms of use")]),e._v(" and "),t("a",{attrs:{href:"#",target:"_blank"}},[e._v("privacy policy")])])])}],J={},$=(0,l.Z)(J,q,M,!1,null,"50a256ae",null),W=$.exports,H=function(){var e=this,t=e._self._c;return t("p",{staticClass:"consent-message"},[t("span",[e._v(" "+e._s(e.message)+" ")])])},G=[],Q={props:{message:{type:String,default:""}}},X=Q,Y=(0,l.Z)(X,H,G,!1,null,"9a296858",null),ee=Y.exports,te=n(9269),ne=function(){var e=this,t=e._self._c;return t("load-ing",{attrs:{active:e.isLoadingPage,"can-cancel":!0,"is-full-page":e.fullPage},on:{"update:active":function(t){e.isLoadingPage=t}}})},se=[],re=n(15006),oe={name:"AuthTication",components:{},computed:{...(0,i.Se)(["getActiveStep"])},data(){return{isLoadingPage:!1,fullPage:!0}},methods:{...(0,i.OI)(["nextStep","setProfile"]),...(0,i.nv)(["registerUser"]),async getUserInfo(e){if(e){const t=this;re.Z.client.userInfo(e,(function(n,s){n&&console.error(n),t.$store.commit("setProfile",{...s,accessToken:e})}))}}},async mounted(){try{console.log("Inside mounted Auth");const e=this.$route.hash,t=e.split("&")[0].split("=")[1],n=e.split("&")[5].split("=")[1],s={provider:"Google",accessToken:t,authToken:n};this.$store.commit("setThridPartyAuth",s),console.log("Before calling getUserInfo"),this.getUserInfo(t),this.isLoadingPage=!0,setTimeout((async()=>{console.log("Before calling registerUser"),await this.registerUser(),console.log("After calling registerUser"),console.log("Inside mounted Auth"),this.nextStep(1),this.isLoadingPage=!1,this.$router.push({path:"/"})}),1500)}catch(e){console.log("error ="+e),this.isLoadingPage=!1,this.nextStep(1),this.$router.push({path:"/"})}}},ae=oe,ie=(0,l.Z)(ae,ne,se,!1,null,null,null),ce=ie.exports;s.ZP.use(te.ZP);const ue=new te.ZP({mode:"history",routes:[{path:"/",name:"MainPage",component:()=>n.e(475).then(n.bind(n,86843)),meta:()=>({requiresAuth:!1,title:"Widget - User Home"})},{path:"/auth/google",name:"AuthTication",component:ce,meta:()=>({requiresAuth:!1,title:"Widget - Google Auth"})}]});var le=ue;s.ZP.config.productionTip=!1,s.ZP.component("load-ing",E()),s.ZP.component("MessageBox",b),s.ZP.component("NavBar",N),s.ZP.component("PageHeading",z),s.ZP.component("PoweredBy",Z.Z),s.ZP.component("ConsentBox",W),s.ZP.component("InfoMessage",ee),new s.ZP({router:le,store:B,render:e=>e(h)}).$mount("#app")},71258:function(e,t,n){n.d(t,{Z:function(){return c}});var s=function(){var e=this,t=e._self._c;return t("div")},r=[],o=n(43736),a={},i=(0,o.Z)(a,s,r,!1,null,"fd7969e0",null),c=i.exports},40633:function(e,t,n){e.exports=n.p+"img/hypersign_black_transparent_rect.9c12af3a.png"}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,s,r,o){if(!s){var a=1/0;for(l=0;l<e.length;l++){s=e[l][0],r=e[l][1],o=e[l][2];for(var i=!0,c=0;c<s.length;c++)(!1&o||a>=o)&&Object.keys(n.O).every((function(e){return n.O[e](s[c])}))?s.splice(c--,1):(i=!1,o<a&&(a=o));if(i){e.splice(l--,1);var u=r();void 0!==u&&(t=u)}}return t}o=o||0;for(var l=e.length;l>0&&e[l-1][2]>o;l--)e[l]=e[l-1];e[l]=[s,r,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(s,r){if(1&r&&(s=this(s)),8&r)return s;if("object"===typeof s&&s){if(4&r&&s.__esModule)return s;if(16&r&&"function"===typeof s.then)return s}var o=Object.create(null);n.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var i=2&r&&s;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((function(e){a[e]=function(){return s[e]}}));return a["default"]=function(){return s},n.d(o,a),o}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,s){return n.f[s](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/MainPage.3c537b87.js"}}(),function(){n.miniCssF=function(e){return"css/MainPage.c7d5fe29.css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="hypersign-kyc-widget:";n.l=function(s,r,o,a){if(e[s])e[s].push(r);else{var i,c;if(void 0!==o)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==s||d.getAttribute("data-webpack")==t+o){i=d;break}}i||(c=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+o),i.src=s),e[s]=[r];var h=function(t,n){i.onerror=i.onload=null,clearTimeout(g);var r=e[s];if(delete e[s],i.parentNode&&i.parentNode.removeChild(i),r&&r.forEach((function(e){return e(n)})),t)return t(n)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=h.bind(null,i.onerror),i.onload=h.bind(null,i.onload),c&&document.head.appendChild(i)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){n.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,n,s,r){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var a=function(n){if(o.onerror=o.onload=null,"load"===n.type)s();else{var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=a,c.request=i,o.parentNode&&o.parentNode.removeChild(o),r(c)}};return o.onerror=o.onload=a,o.href=t,n?n.parentNode.insertBefore(o,n.nextSibling):document.head.appendChild(o),o},t=function(e,t){for(var n=document.getElementsByTagName("link"),s=0;s<n.length;s++){var r=n[s],o=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(o===e||o===t))return r}var a=document.getElementsByTagName("style");for(s=0;s<a.length;s++){r=a[s],o=r.getAttribute("data-href");if(o===e||o===t)return r}},s=function(s){return new Promise((function(r,o){var a=n.miniCssF(s),i=n.p+a;if(t(a,i))return r();e(s,i,null,r,o)}))},r={143:0};n.f.miniCss=function(e,t){var n={475:1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=s(e).then((function(){r[e]=0}),(function(t){throw delete r[e],t})))}}}(),function(){var e={143:0};n.f.j=function(t,s){var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)s.push(r[2]);else{var o=new Promise((function(n,s){r=e[t]=[n,s]}));s.push(r[2]=o);var a=n.p+n.u(t),i=new Error,c=function(s){if(n.o(e,t)&&(r=e[t],0!==r&&(e[t]=void 0),r)){var o=s&&("load"===s.type?"missing":s.type),a=s&&s.target&&s.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",i.name="ChunkLoadError",i.type=o,i.request=a,r[1](i)}};n.l(a,c,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,s){var r,o,a=s[0],i=s[1],c=s[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(r in i)n.o(i,r)&&(n.m[r]=i[r]);if(c)var l=c(n)}for(t&&t(s);u<a.length;u++)o=a[u],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(l)},s=self["webpackChunkhypersign_kyc_widget"]=self["webpackChunkhypersign_kyc_widget"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(64072)}));s=n.O(s)})();
//# sourceMappingURL=app.3321778b.js.map